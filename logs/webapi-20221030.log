[2022-10-30 02:39:32.860 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 02:39:32.927 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 02:39:32.928 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 02:39:32.928 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 02:39:36.163 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  12 INF] [] HTTP GET /swagger/index.html responded 200 in 712.2657 ms
[2022-10-30 02:39:37.191 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  8 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 432.9082 ms
[2022-10-30 02:39:59.601 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  14 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 02:40:01.938 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  14 INF] [] HTTP POST /api/Authentication responded 200 in 2352.3949 ms
[2022-10-30 02:41:49.301 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 02:41:49.395 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 02:41:49.395 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 02:41:49.395 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 02:41:52.297 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  17 INF] [] HTTP GET /swagger/index.html responded 200 in 931.9430 ms
[2022-10-30 02:41:53.622 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  9 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 600.6192 ms
[2022-10-30 02:42:24.569 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  29 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 02:42:25.590 +01:00 Microsoft.EntityFrameworkCore.Query  29 WRN] [Christopher Carr (0078)] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
[2022-10-30 02:42:26.588 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  29 INF] [] HTTP GET /api/Timesheet/2022-18SS/Export responded 200 in 2030.1421 ms
[2022-10-30 03:24:32.598 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:24:32.661 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:24:32.662 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:24:32.662 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:24:35.125 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 673.1722 ms
[2022-10-30 03:24:36.318 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  10 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 522.4367 ms
[2022-10-30 03:25:05.189 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  15 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:25:08.004 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  20 ERR] [] HTTP GET /api/Timesheet/2022-18SS/Export responded 500 in 2825.4525 ms
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE tpayrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE tpayrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Invalid column name 'tpayrollPeriod'.
Invalid column name 'tpayrollPeriod'.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 470
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2022-10-30 03:25:08.163 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  20 ERR] [] An unhandled exception has occurred while executing the request.
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE tpayrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE tpayrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Invalid column name 'tpayrollPeriod'.
Invalid column name 'tpayrollPeriod'.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 470
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:25:08.173 +01:00   20 ERR] [] System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE tpayrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE tpayrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Invalid column name 'tpayrollPeriod'.
Invalid column name 'tpayrollPeriod'.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 470
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:27:48.168 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:27:48.507 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:27:48.508 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:27:48.508 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:27:50.648 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  7 INF] [] HTTP GET /swagger/index.html responded 200 in 783.5337 ms
[2022-10-30 03:27:52.974 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  9 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 379.0036 ms
[2022-10-30 03:28:14.101 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  5 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:28:16.259 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  8 ERR] [] HTTP GET /api/Timesheet/2022-18SS/Export responded 500 in 2170.4924 ms
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Incorrect syntax near 'tho'.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 472
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2022-10-30 03:28:16.396 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  8 ERR] [] An unhandled exception has occurred while executing the request.
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Incorrect syntax near 'tho'.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 472
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:28:16.406 +01:00   8 ERR] [] System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Incorrect syntax near 'tho'.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 472
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:29:21.957 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:29:22.033 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:29:22.034 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:29:22.034 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:29:24.328 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 647.0639 ms
[2022-10-30 03:29:25.324 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  13 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 463.6311 ms
[2022-10-30 03:30:51.215 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  19 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:30:53.434 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  20 ERR] [] HTTP GET /api/Timesheet/2022-18SS/Export responded 500 in 2228.8989 ms
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname,
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Must declare the scalar variable "@isSalaried".
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 472
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2022-10-30 03:30:53.559 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  20 ERR] [] An unhandled exception has occurred while executing the request.
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname,
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Must declare the scalar variable "@isSalaried".
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 472
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:30:53.565 +01:00   20 ERR] [] System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname,
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
Must declare the scalar variable "@isSalaried".
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 472
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:32:21.827 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  28 INF] [] HTTP GET /swagger/index.html responded 200 in 38.4825 ms
[2022-10-30 03:32:22.938 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  31 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 57.8643 ms
[2022-10-30 03:33:25.352 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:33:25.470 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:33:25.471 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:33:25.471 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:33:27.652 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 613.1110 ms
[2022-10-30 03:33:28.812 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  8 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 415.2927 ms
[2022-10-30 03:33:59.250 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  6 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:34:01.481 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 ERR] [] HTTP GET /api/Timesheet/2022-18SS/Export responded 500 in 2248.6220 ms
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname,
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 475
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2022-10-30 03:34:01.623 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  6 ERR] [] An unhandled exception has occurred while executing the request.
System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname,
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 475
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:34:01.629 +01:00   6 ERR] [] System.Exception: 
            SELECT * 
            FROM (
            SELECT 
                te.Id AS TimesheetEntryId,
                te.EmployeeId AS EmployeeId,
                e.FullName AS Fullname,
                te.WorkDate  as WorkDate,
                te.PayrollCode  as PayrollCode,
                te.Hours  as Quantity,
                te.CustomerNumber  as CustomerNumber,
                te.JobNumber  as JobNumber,
                te.JobDescription  as JobDescription,
                te.LaborCode  as LaborCode,
                te.ServiceOrderNumber  as ServiceOrderNumber,
                te.ProfitCenterNumber  as ProfitCenterNumber,
                e.Department  as Department,
                te.Description  as Description,
                te.OutOffCountry  as OutOffCountry,
                te.Status  as TimesheetEntryStatus
            FROM timesheetEntry te
            JOIN timesheets t on t.id = te.TimesheetHeaderId
            JOIN employees e on e.Id = te.EmployeeId
            WHERE t.payrollPeriod = @payrollPeriod
        ) entries
            UNION ALL (
            SELECT 
                tho.Id AS TimesheetEntryId,
                e.Id AS EmployeeId,
                e.FullName AS Fullname,
                tho.TimesheetHeaderId AS TimesheetHeaderId,
                tho.WorkDate  as WorkDate,
                tho.PayrollCode  as PayrollCode,
                tho.Hours  as Quantity,
                null  as CustomerNumber,
                null  as JobNumber,
                null  as JobDescription,
                null  as LaborCode,
                null  as ServiceOrderNumber,
                null  as ProfitCenterNumber,
                e.Department  as Department,
                tho.Description  as Description,
                null  as OutOffCountry,
                tho.Status  as TimesheetEntryStatus
            FROM timesheetHoliday tho
            JOIN timesheets t on t.id = tho.TimesheetHeaderId
            JOIN employees e on (
                (e.IsSalaried = @isSalaried AND t.type = @weeklyTimesheet) 
                OR 
                (e.IsSalaried != @isSalaried AND t.type = @monthlyTimesheet))
            WHERE t.payrollPeriod = @payrollPeriod
        )
            ORDER BY 2
        
All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.
   at Timesheet.Infrastructure.Dapper.DatabaseService.QueryAsync[T](String query, Object params) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Infrastructure.Dapper\DatabaseService.cs:line 34
   at Timesheet.Infrastructure.Persistence.Queries.QueryTimesheet.GetAllEmployeeTimesheetByPayrollPeriod(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.ReadModel\Queries\QueryTimesheet.cs:line 475
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.PrepareExport(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 62
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.GetTimesheetAsCsv(String payrollPeriod, Boolean checkFinalizedState) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 55
   at Timesheet.Application.Timesheets.Services.Export.ExportTimesheetService.ExportToWeb(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\Services\Export\ExportTimesheetService.cs:line 46
   at Timesheet.Web.Api.Controllers.TimesheetController.ExportTimesheet(String payrollPeriod) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 114
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:35:07.665 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:35:07.713 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:35:07.713 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:35:07.713 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:35:09.685 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 553.4897 ms
[2022-10-30 03:35:10.689 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  10 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 350.2776 ms
[2022-10-30 03:35:33.974 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  20 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:35:36.035 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  21 INF] [] HTTP GET /api/Timesheet/2022-18SS/Export responded 200 in 2071.1148 ms
[2022-10-30 03:38:14.768 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:38:14.855 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:38:14.855 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:38:14.856 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:38:17.560 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 1198.5090 ms
[2022-10-30 03:38:18.644 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  3 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 535.7372 ms
[2022-10-30 03:38:41.159 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  3 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:38:42.253 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  5 INF] [] HTTP GET /api/Timesheet/2022-18SS/Export responded 200 in 1101.7186 ms
[2022-10-30 03:40:00.620 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:40:00.730 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:40:00.732 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:40:00.732 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:40:03.075 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  7 INF] [] HTTP GET /swagger/index.html responded 200 in 549.8272 ms
[2022-10-30 03:40:04.251 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  13 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 631.2827 ms
[2022-10-30 03:40:39.987 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  15 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:40:40.635 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  15 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 03:41:09.204 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  17 ERR] [] HTTP PUT /api/Timesheet/Finalize responded 500 in 29225.5908 ms
System.NullReferenceException: Object reference not set to an instance of an object.
   at Timesheet.Application.BaseCommandHandler`2.GetCurrentEmployeeRoleOnData(BaseCommand command, Employee employee) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 86
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 36
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at System.Dynamic.UpdateDelegates.UpdateAndExecuteVoid1[T0](CallSite site, T0 arg0)
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2022-10-30 03:41:09.324 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  17 ERR] [] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Timesheet.Application.BaseCommandHandler`2.GetCurrentEmployeeRoleOnData(BaseCommand command, Employee employee) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 86
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 36
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at System.Dynamic.UpdateDelegates.UpdateAndExecuteVoid1[T0](CallSite site, T0 arg0)
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:41:09.333 +01:00   17 ERR] [] System.NullReferenceException: Object reference not set to an instance of an object.
   at Timesheet.Application.BaseCommandHandler`2.GetCurrentEmployeeRoleOnData(BaseCommand command, Employee employee) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 86
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 36
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at System.Dynamic.UpdateDelegates.UpdateAndExecuteVoid1[T0](CallSite site, T0 arg0)
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:41:15.890 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  15 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 03:41:39.155 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  18 ERR] [] HTTP PUT /api/Timesheet/Finalize responded 500 in 23292.7632 ms
System.NullReferenceException: Object reference not set to an instance of an object.
   at Timesheet.Application.BaseCommandHandler`2.GetCurrentEmployeeRoleOnData(BaseCommand command, Employee employee) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 86
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 36
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2022-10-30 03:41:39.818 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  18 ERR] [] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Timesheet.Application.BaseCommandHandler`2.GetCurrentEmployeeRoleOnData(BaseCommand command, Employee employee) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 86
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 36
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:41:39.842 +01:00   18 ERR] [] System.NullReferenceException: Object reference not set to an instance of an object.
   at Timesheet.Application.BaseCommandHandler`2.GetCurrentEmployeeRoleOnData(BaseCommand command, Employee employee) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 86
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 36
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 03:41:42.653 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  25 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 03:43:44.404 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:43:44.452 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:43:44.452 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:43:44.452 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:43:46.748 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 930.8495 ms
[2022-10-30 03:43:47.667 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  5 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 424.0189 ms
[2022-10-30 03:44:13.272 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  16 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:44:13.839 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  16 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 03:47:21.779 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:47:21.824 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:47:21.825 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:47:21.825 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:47:23.938 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  7 INF] [] HTTP GET /swagger/index.html responded 200 in 461.3489 ms
[2022-10-30 03:47:25.001 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  17 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 493.6294 ms
[2022-10-30 03:48:10.601 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  21 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:48:11.136 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  21 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 03:49:10.184 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:49:10.225 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:49:10.225 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:49:10.226 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:49:12.259 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  7 INF] [] HTTP GET /swagger/index.html responded 200 in 657.7019 ms
[2022-10-30 03:49:13.243 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  5 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 402.4538 ms
[2022-10-30 03:53:11.915 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 03:53:11.964 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 03:53:11.965 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 03:53:11.965 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 03:53:15.549 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  12 INF] [] HTTP GET /swagger/index.html responded 200 in 418.0216 ms
[2022-10-30 03:53:16.479 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  13 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 495.3724 ms
[2022-10-30 03:53:42.899 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  20 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 03:53:43.439 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  20 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:05:13.400 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 04:05:13.494 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 04:05:13.495 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 04:05:13.495 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 04:05:15.176 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 433.8944 ms
[2022-10-30 04:05:16.045 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  13 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 392.0583 ms
[2022-10-30 04:05:39.980 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  10 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 04:05:40.514 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  10 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:06:23.855 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  19 INF] [Christopher Carr (0078)] Timesheet (2022-18SS) Updated
[2022-10-30 04:06:23.867 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  19 INF] [] HTTP PUT /api/Timesheet/Finalize responded 200 in 43893.9350 ms
[2022-10-30 04:08:36.156 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  25 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:08:36.591 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  25 ERR] [] HTTP PUT /api/Timesheet/Finalize responded 500 in 473.3477 ms
Timesheet.Exceptions.InvalidWorkflowOperation`1[Timesheet.Domain.Models.Timesheets.TimesheetHeader]: Role ADMINISTRATOR is not allowed to FINALIZE Timesheet.Domain.Models.Timesheets.TimesheetHeader (Id: 2022-18SS) with current status (FINALIZED).
   at Timesheet.Application.Workflow.WorkflowDefinition.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowDefinition.cs:line 30
   at Timesheet.Application.Workflow.WorkflowService.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowService.cs:line 24
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 37
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2022-10-30 04:08:36.719 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  25 ERR] [] An unhandled exception has occurred while executing the request.
Timesheet.Exceptions.InvalidWorkflowOperation`1[Timesheet.Domain.Models.Timesheets.TimesheetHeader]: Role ADMINISTRATOR is not allowed to FINALIZE Timesheet.Domain.Models.Timesheets.TimesheetHeader (Id: 2022-18SS) with current status (FINALIZED).
   at Timesheet.Application.Workflow.WorkflowDefinition.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowDefinition.cs:line 30
   at Timesheet.Application.Workflow.WorkflowService.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowService.cs:line 24
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 37
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 04:08:36.727 +01:00   25 ERR] [] Timesheet.Exceptions.InvalidWorkflowOperation`1[Timesheet.Domain.Models.Timesheets.TimesheetHeader]: Role ADMINISTRATOR is not allowed to FINALIZE Timesheet.Domain.Models.Timesheets.TimesheetHeader (Id: 2022-18SS) with current status (FINALIZED).
   at Timesheet.Application.Workflow.WorkflowDefinition.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowDefinition.cs:line 30
   at Timesheet.Application.Workflow.WorkflowService.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowService.cs:line 24
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 37
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 04:09:29.452 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  27 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:09:46.123 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  28 INF] [Christopher Carr (0078)] Timesheet (2022-18SS) Updated
[2022-10-30 04:09:46.125 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  28 INF] [] HTTP PUT /api/Timesheet/Finalize responded 200 in 16683.9975 ms
[2022-10-30 04:10:24.948 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  31 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:12:59.525 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  39 INF] [Christopher Carr (0078)] Timesheet (2022-18SS) Updated
[2022-10-30 04:12:59.525 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  39 INF] [] HTTP PUT /api/Timesheet/Finalize responded 200 in 154578.0183 ms
[2022-10-30 04:14:53.417 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  17 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:14:59.587 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  10 INF] [Christopher Carr (0078)] Timesheet (2022-18SS) Updated
[2022-10-30 04:14:59.587 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  10 INF] [] HTTP PUT /api/Timesheet/Finalize responded 200 in 6171.1098 ms
[2022-10-30 04:17:57.635 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 04:17:57.688 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 04:17:57.688 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 04:17:57.688 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 04:18:00.293 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  7 INF] [] HTTP GET /swagger/index.html responded 200 in 537.0981 ms
[2022-10-30 04:18:01.614 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  17 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 651.0719 ms
[2022-10-30 04:19:43.432 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  19 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 04:19:44.000 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  19 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:19:45.768 +01:00 Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware  23 ERR] [] An unhandled exception has occurred while executing the request.
Timesheet.Exceptions.InvalidWorkflowOperation`1[Timesheet.Domain.Models.Timesheets.TimesheetHeader]: Role ADMINISTRATOR is not allowed to FINALIZE Timesheet.Domain.Models.Timesheets.TimesheetHeader (Id: 2022-18SS) with current status (FINALIZED).
   at Timesheet.Application.Workflow.WorkflowDefinition.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowDefinition.cs:line 30
   at Timesheet.Application.Workflow.WorkflowService.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowService.cs:line 24
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 37
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at System.Dynamic.UpdateDelegates.UpdateAndExecuteVoid1[T0](CallSite site, T0 arg0)
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 04:19:52.875 +01:00   23 ERR] [] Timesheet.Exceptions.InvalidWorkflowOperation`1[Timesheet.Domain.Models.Timesheets.TimesheetHeader]: Role ADMINISTRATOR is not allowed to FINALIZE Timesheet.Domain.Models.Timesheets.TimesheetHeader (Id: 2022-18SS) with current status (FINALIZED).
   at Timesheet.Application.Workflow.WorkflowDefinition.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowDefinition.cs:line 30
   at Timesheet.Application.Workflow.WorkflowService.AuthorizeTransition[TEntity](TEntity entity, Enum transition, Enum currentStatus, EmployeeRoleOnData authorRole) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Workflow\WorkflowService.cs:line 24
   at Timesheet.Application.Timesheets.CommandHandlers.FinalizeTimesheetCommandHandler.HandleCoreAsync(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Timesheets\CommandHandlers\FinalizeTimesheetCommandHandler.cs:line 37
   at Timesheet.Application.BaseCommandHandler`2.HandleAsync(TCommand command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\BaseCommandHandler.cs:line 63
   at System.Dynamic.UpdateDelegates.UpdateAndExecuteVoid1[T0](CallSite site, T0 arg0)
   at Timesheet.Application.Dispatcher.RunCommand[TCommand](TCommand command, User author, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Application\Shared\Dispatcher.cs:line 64
   at Timesheet.Web.Api.Controllers.TimesheetController.Finalize(FinalizeTimesheet command, CancellationToken token) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Controllers\TimesheetController.cs:line 163
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Timesheet.Web.Api.Middleware.LogUserNameMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\Middleware\LogUserNameMiddleware.cs:line 15
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.<>c__DisplayClass6_1.<<UseMiddlewareInterface>b__1>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
[2022-10-30 04:19:52.888 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  23 INF] [] HTTP PUT /api/Timesheet/Finalize responded 403 in 9473.7132 ms
[2022-10-30 04:20:38.572 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  28 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:20:41.587 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  31 INF] [Christopher Carr (0078)] Timesheet (2022-18SS) Updated
[2022-10-30 04:20:41.589 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  31 INF] [] HTTP PUT /api/Timesheet/Finalize responded 200 in 3121.7462 ms
[2022-10-30 04:22:52.328 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Now listening on: http://localhost:5148
[2022-10-30 04:22:52.372 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Application started. Press Ctrl+C to shut down.
[2022-10-30 04:22:52.372 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Hosting environment: Development
[2022-10-30 04:22:52.372 +01:00 Microsoft.Hosting.Lifetime  1 INF] [] Content root path: C:\Users\Hp\Documents\WFE-Timesheet Track\source\Timesheet\Timesheet.Web.Api\
[2022-10-30 04:22:55.186 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  6 INF] [] HTTP GET /swagger/index.html responded 200 in 758.7301 ms
[2022-10-30 04:22:56.151 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  16 INF] [] HTTP GET /swagger/v1/swagger.json responded 200 in 428.4123 ms
[2022-10-30 04:23:21.129 +01:00 Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware  20 WRN] [] Failed to determine the https port for redirect.
[2022-10-30 04:23:21.701 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  20 INF] [Christopher Carr (0078)] Finalize timesheet (2022-18SS)
[2022-10-30 04:24:01.263 +01:00 Timesheet.Web.Api.Controllers.TimesheetController  32 INF] [Christopher Carr (0078)] Timesheet (2022-18SS) Updated
[2022-10-30 04:24:01.275 +01:00 Serilog.AspNetCore.RequestLoggingMiddleware  32 INF] [] HTTP PUT /api/Timesheet/Finalize responded 200 in 40160.4124 ms
